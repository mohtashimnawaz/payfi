(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[549],{1021:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/prover",function(){return t(3046)}])},3046:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ProverPage}});var i=t(5893),r=t(7294),a=t(7158),o=t(4861),s=t(8764).lW;function ProverPage(){let[e,n]=(0,r.useState)("idle"),[t,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(""),[p,f]=(0,r.useState)(null),[g,x]=(0,r.useState)(!1),[w,m]=(0,r.useState)({leaf:"987654321",path_hashes:"1234567",index:"1",secret:"424242"}),[y,j]=(0,r.useState)("");async function connectWallet(){try{var e;if(!(null===(e=window.solana)||void 0===e?void 0:e.isPhantom)){l("❌ Phantom wallet not installed");return}let n=await window.solana.connect();f(n.publicKey),x(!0),l("✅ Connected wallet: ".concat(n.publicKey.toBase58().slice(0,8),"..."))}catch(e){l("❌ Wallet connection failed: ".concat(String(e)))}}async function disconnectWallet(){try{var e;await (null===(e=window.solana)||void 0===e?void 0:e.disconnect()),f(null),x(!1),l("✅ Disconnected wallet")}catch(e){l("❌ Disconnect failed: ".concat(String(e)))}}async function generateProof(){n("running"),l("Generating proof with test vectors...");try{l("Loading test vectors...");let e={a:parseInt(w.leaf),b:parseInt(w.path_hashes),c:parseInt(w.index),d:parseInt(w.secret)},t={proof:s.from([0,1,2,3]),publicInputs:[e.a.toString(),e.b.toString()]};d(t);let i=JSON.stringify({proof:Array.from(new Uint8Array(t.proof)),publicInputs:t.publicInputs});h(i),l("✅ Proof generated! Ready to submit to chain."),n("done")}catch(e){console.error(e),l("❌ Error: "+String(e)),n("error")}}async function submitProofToChain(){j("submitting...");try{if(!g||!p){j('❌ Wallet not connected. Click "Connect Wallet" first.');return}if(!u){j('❌ No proof generated. Click "Generate Proof" first.');return}j("Connecting to validator...");let e=new a.Connection("http://127.0.0.1:8899","confirmed");new o.Y7(e,{publicKey:p,signTransaction:async e=>{let n=await window.solana.signTransaction(e);return n},signAllTransactions:async e=>{let n=await Promise.all(e.map(e=>window.solana.signTransaction(e)));return n}},{preflightCommitment:"confirmed"}),j("Building verification instruction..."),JSON.parse(u);let n=["990123457","988502805"],t=new Uint8Array([100,98,165,253]),createVecBytes=e=>{let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e.length,!0),new Uint8Array([...n,...e])},i=new TextEncoder().encode(u),r=createVecBytes(i),l=new Uint8Array(4);new DataView(l.buffer).setUint32(0,n.length,!0);let c=[];for(let e of n){let n=new TextEncoder().encode(e);c.push(createVecBytes(n))}let d=t.length+r.length+l.length;for(let e of c)d+=e.length;let h=new Uint8Array(d),f=0;for(let e of(h.set(t,f),f+=t.length,h.set(r,f),f+=r.length,h.set(l,f),f+=l.length,c))h.set(e,f),f+=e.length;let x=new a.Transaction;x.add(new a.TransactionInstruction({programId:new a.PublicKey("H7vpWaLWY1dDc8odHnZ3p4SMRT89uDe6WRpaP5ewwWoh"),keys:[{pubkey:p,isSigner:!1,isWritable:!1}],data:s.from(h)})),j("⏳ Signing transaction with Phantom..."),x.recentBlockhash=(await e.getLatestBlockhash()).blockhash,x.feePayer=p;let w=await window.solana.signTransaction(x);j("\uD83D\uDCE4 Sending verification transaction...");let m=await e.sendRawTransaction(w.serialize());j("✅ Proof submitted! Signature: ".concat(m.slice(0,16),"..."))}catch(e){console.error(e),j("❌ "+String(e))}}return(0,r.useEffect)(()=>{var e;(null===(e=window.solana)||void 0===e?void 0:e.isPhantom)?l("✅ Phantom wallet detected"):l("⚠️ Phantom wallet not found. Install from https://phantom.app")},[]),(0,i.jsxs)("main",{style:{padding:24,maxWidth:800,margin:"0 auto"},children:[(0,i.jsx)("h1",{children:"\uD83D\uDD10 PayFi Browser Prover"}),(0,i.jsx)("p",{children:"Generate ZK proofs client-side. Secrets never leave the browser."}),(0,i.jsxs)("section",{style:{marginBottom:32,padding:16,border:"1px solid #ddd",borderRadius:8},children:[(0,i.jsx)("h2",{children:"0. Connect Wallet"}),g?(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"✅ Connected:"})," ",null==p?void 0:p.toBase58().slice(0,16),"..."]}),(0,i.jsx)("button",{onClick:disconnectWallet,style:{padding:"10px 20px",fontSize:16,cursor:"pointer"},children:"\uD83D\uDD13 Disconnect"})]}):(0,i.jsx)("button",{onClick:connectWallet,style:{padding:"10px 20px",fontSize:16,cursor:"pointer"},children:"\uD83D\uDD17 Connect Phantom Wallet"})]}),(0,i.jsxs)("section",{style:{marginBottom:32,padding:16,border:"1px solid #ddd",borderRadius:8},children:[(0,i.jsx)("h2",{children:"1. Generate Proof"}),(0,i.jsxs)("div",{style:{display:"grid",gap:8,maxWidth:420},children:[(0,i.jsxs)("label",{children:["Leaf ",(0,i.jsx)("input",{value:w.leaf,onChange:e=>m({...w,leaf:e.target.value})})]}),(0,i.jsxs)("label",{children:["Path hashes ",(0,i.jsx)("input",{value:w.path_hashes,onChange:e=>m({...w,path_hashes:e.target.value})})]}),(0,i.jsxs)("label",{children:["Index ",(0,i.jsx)("input",{value:w.index,onChange:e=>m({...w,index:e.target.value})})]}),(0,i.jsxs)("label",{children:["Secret ",(0,i.jsx)("input",{value:w.secret,onChange:e=>m({...w,secret:e.target.value})})]}),(0,i.jsx)("button",{onClick:generateProof,disabled:"running"===e,style:{padding:"10px 20px",fontSize:16,cursor:"pointer"},children:"running"===e?"⏳ Generating...":"\uD83E\uDDEE Generate Proof"})]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Status:"})," ",e]}),(0,i.jsx)("pre",{style:{background:"#f5f5f5",padding:12,borderRadius:4,fontSize:12},children:t})]}),u&&(0,i.jsxs)("section",{style:{marginBottom:32,padding:16,border:"1px solid #ddd",borderRadius:8},children:[(0,i.jsx)("h2",{children:"2. Submit to Chain"}),(0,i.jsx)("p",{children:(0,i.jsx)("strong",{children:"Serialized proof (base64):"})}),(0,i.jsx)("textarea",{value:u,readOnly:!0,style:{width:"100%",height:80,fontFamily:"monospace",fontSize:12}}),(0,i.jsx)("button",{onClick:submitProofToChain,disabled:!g,style:{marginTop:12,padding:"10px 20px",fontSize:16,cursor:g?"pointer":"not-allowed",opacity:g?1:.5},children:"⛓️ Submit Proof to Verifier"}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Submit Status:"})," ",y||"(ready to submit)"]})]}),(0,i.jsx)("hr",{}),(0,i.jsxs)("details",{children:[(0,i.jsx)("summary",{style:{cursor:"pointer"},children:"\uD83D\uDCCB Dev Notes"}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:["Ensure ",(0,i.jsx)("code",{children:"@noir-lang/noir_wasm"})," is installed: ",(0,i.jsx)("code",{children:"npm install @noir-lang/noir_wasm"})]}),(0,i.jsxs)("li",{children:["Export WASM: ",(0,i.jsx)("code",{children:"cd zk/noir && make export-wasm"})]}),(0,i.jsxs)("li",{children:["Local validator: ",(0,i.jsx)("code",{children:"solana-test-validator --reset"})]}),(0,i.jsxs)("li",{children:["Requires Phantom wallet: ",(0,i.jsx)("a",{href:"https://phantom.app",target:"_blank",children:"phantom.app"})]}),(0,i.jsx)("li",{children:"TODO: Wire actual verifier program IDL for on-chain calls"})]})]})]})}},3196:function(){}},function(e){e.O(0,[774,347,999,830,467,888,179],function(){return e(e.s=1021)}),_N_E=e.O()}]);